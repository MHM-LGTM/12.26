# 动画广场实施计划（大白话版）

## 🎯 最终效果

完成后你会看到：
```
┌────────────画布──────────────┬──我的动画(3列)──┐
│                             │ ┌──┐┌──┐┌──┐  │
│                             │ └──┘└──┘└──┘  │
│        [开始模拟] [下载动画]  │               │
└─────────────────────────────┴────────────────┘
┌─────────────────────────────────────────────┐
│  📝 碰撞演示        ❤️ 128 (可点击)  👤 张三  │ ← 动画信息区（点击广场动画时显示）
└─────────────────────────────────────────────┘
┌─────────────────────────────────────────────┐
│  动画广场                                    │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐               │ ← 横向滚动
│  │封面│ │封面│ │封面│ │封面│ ...            │
│  └────┘ └────┘ └────┘ └────┘               │
│   碰撞   单摆   滑块   弹簧                  │
│  ❤️ 128 ❤️ 89  ❤️ 45  ❤️ 234               │
└─────────────────────────────────────────────┘
```

---

## 📝 接下来要做的事（按顺序）

### 第一步：给"我的动画"卡片加操作菜单（30分钟）

**要做什么：**
在"我的动画"的每个卡片上加一个"三个点"的菜单按钮

**具体操作：**
1. 鼠标悬浮在卡片上 → 右上角出现"⋯"按钮
2. 点击"⋯" → 弹出菜单：
   - 🗑️ 删除
   - 📤 上传到广场
   - 🔗 分享链接

**后端需要：**
- 已有删除接口（阶段一做好了）
- 新增：`POST /api/animations/{id}/publish` - 发布到广场
- 新增：`POST /api/animations/{id}/share-link` - 生成分享链接

**前端需要：**
- 修改 `MyAnimationsPanel.jsx`
- 添加菜单组件
- 连接后端接口

---

### 第二步：在页面底部创建"动画广场"面板（1小时）

**要做什么：**
在页面底部加一个横向滚动的面板，显示所有公开的动画

**具体操作：**
1. 创建 `PlazaPanel.jsx` 组件
2. 在 `PhysicsPage.jsx` 中添加到底部
3. 横向滚动显示卡片

**每个卡片显示：**
- 封面图（小一点）
- 动画名称
- ❤️ 点赞数（可以点击）

**后端需要：**
- 新增：`GET /api/plaza/animations` - 获取广场动画列表
  - 返回所有 `is_public=true` 的动画
  - 按点赞数降序排序

**前端需要：**
- 创建 `PlazaPanel.jsx` 组件
- 横向滚动布局（CSS）
- 显示卡片列表

---

### 第三步：实现点击广场卡片加载动画（30分钟）

**要做什么：**
点击广场的动画卡片，动画加载到画布上

**具体操作：**
1. 点击卡片 → 卡片变大一点，加蓝色边框（选中状态）
2. 动画加载到画布（复用之前的 loadAnimation）
3. 画布下方出现"动画信息区"，显示：
   - 动画名称
   - 描述
   - ❤️ 点赞数
   - 👤 作者（如果公开了）

**后端需要：**
- 新增：`GET /api/plaza/animations/{id}` - 获取广场动画详情（公开接口，不需要登录）

**前端需要：**
- 修改 `PlazaPanel.jsx` - 添加点击事件
- 创建 `AnimationInfoBar.jsx` - 画布下方的信息区
- 管理选中状态

---

### 第四步：实现点赞功能（双入口）（1小时）

**要做什么：**
在两个地方都可以点赞：
1. 广场卡片上的 ❤️
2. 画布下方信息区的 ❤️

**具体操作：**
- 未点赞：灰色空心 ❤️
- 已点赞：红色实心 ❤️
- 点击切换状态
- 点赞数实时更新
- 未登录点击 → 提示登录

**后端需要：**
- 新增：`POST /api/plaza/animations/{id}/like` - 点赞
- 新增：`DELETE /api/plaza/animations/{id}/like` - 取消点赞
- 新增：`GET /api/plaza/animations/{id}/like-status` - 查询是否已点赞

**前端需要：**
- 点赞按钮组件
- 状态管理（已点赞/未点赞）
- 连接后端接口

---

### 第五步：实现 Fork 功能（30分钟）

**要做什么：**
点击广场动画的"下载"按钮，将动画复制到"我的动画"

**具体操作：**
1. 加载广场动画后，点击"下载"按钮
2. 后端创建一个副本到你的动画库
3. "我的动画"面板自动刷新，看到新动画
4. 你可以修改这个副本，不影响原作者的动画

**后端需要：**
- 新增：`POST /api/plaza/animations/{id}/fork` - Fork 动画
  - 复制 scene_data
  - user_id 改为当前用户
  - fork_from 记录来源

**前端需要：**
- 修改"下载"按钮逻辑：
  - 如果是自己创建的 → 保存/更新
  - 如果是广场动画 → Fork

---

### 第六步：实现分享链接（1小时）

**要做什么：**
生成一个分享链接，朋友打开后直接看到动画

**具体操作：**
1. 在"我的动画"卡片菜单中点击"分享"
2. 弹窗显示链接：`https://physmath.cn/play/abc123`
3. 点击"复制"按钮
4. 朋友打开链接 → 跳转到播放页
5. 播放页自动加载并运行动画

**后端需要：**
- 新增：`POST /api/animations/{id}/share-link` - 生成分享码
- 新增：`GET /api/play/{share_code}` - 获取动画（公开接口）

**前端需要：**
- 分享链接弹窗
- 创建播放页：`/physics/play/:shareCode`
- 播放页自动加载和运行

---

## 📊 简化版时间规划

| 步骤 | 任务 | 预计时间 | 难度 |
|------|------|---------|------|
| 1 | 卡片操作菜单（删除、上传、分享） | 30分钟 | ⭐ |
| 2 | 动画广场面板（横向滚动） | 1小时 | ⭐⭐ |
| 3 | 点击加载 + 选中状态 + 信息区 | 30分钟 | ⭐ |
| 4 | 点赞功能（双入口） | 1小时 | ⭐⭐ |
| 5 | Fork功能 | 30分钟 | ⭐ |
| 6 | 分享链接 + 播放页 | 1小时 | ⭐⭐ |

**总计：约 4.5-5 小时**

---

## 🎯 核心要点

### 已经完成的（不用再做）
- ✅ 数据库表（已经创建好了）
- ✅ "我的动画"显示（已经做好了）
- ✅ "我的动画"加载（已经做好了）
- ✅ 保存动画（已经做好了）
- ✅ 基础的 API 接口（大部分已经写好了）

### 需要新增的
- 📤 上传到广场（后端1个接口 + 前端菜单）
- 📺 广场展示（后端1个接口 + 前端1个组件）
- 💗 点赞系统（后端3个接口 + 前端交互）
- 🍴 Fork功能（后端1个接口 + 前端逻辑）
- 🔗 分享链接（后端2个接口 + 前端播放页）

---

## 💡 实施建议

### 方式一：一口气做完（5小时）
- 适合周末或有整块时间
- 一次性实现完整功能
- 最后统一测试

### 方式二：分3次完成（推荐）
- **第1次（1.5小时）**：步骤1+2
  - 卡片菜单
  - 广场面板
  - 验收：能看到广场，能上传
  
- **第2次（1.5小时）**：步骤3+4
  - 点击加载
  - 点赞功能
  - 验收：能加载广场动画，能点赞
  
- **第3次（1.5小时）**：步骤5+6
  - Fork功能
  - 分享链接
  - 验收：完整功能上线

---

## 🚀 开始的话...

**我会这样帮你：**

每个步骤我都会：
1. 写好后端接口代码
2. 写好前端组件代码
3. 告诉你怎么测试
4. 有问题立即修复

**你只需要：**
1. 告诉我"开始第X步"
2. 测试我写的代码
3. 反馈有没有问题
4. 看到效果，验收通过

---

## 🎮 快速决策

**现在你可以选择：**

### 选项A：立即开始第一步
"好的，现在开始第一步：给卡片加菜单"

### 选项B：一次性做完整个广场
"好的，把6个步骤全部完成"

### 选项C：先看看具体某一步怎么做
"先告诉我第X步具体怎么实现"

---

**准备好了吗？告诉我你的选择！** 🚀

