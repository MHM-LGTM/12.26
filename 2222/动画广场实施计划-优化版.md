# 动画广场实施计划（优化版）

## 🎯 按照用户思路重新规划

你的思路非常好！**先有广场再上传，逻辑更清晰**。

---

## 📝 分4个阶段实施

### 🏗️ 第一阶段：基础广场 + 上传功能（1.5小时）

#### 要做什么
1. 先在页面底部创建一个简单的"动画广场"面板（空的也行，或者用假数据）
2. 在"我的动画"卡片上加操作菜单（删除、上传到广场）
3. 点击"上传到广场" → 动画出现在广场面板中
4. 保存动画时，弹窗询问"是否同时上传到广场"（可选"不再提醒"）

#### 具体任务

**后端（30分钟）：**
- ✅ `POST /api/animations/{id}/publish` - 上传到广场
  - 设置 `is_public = true`
  - 可选参数 `show_author`（是否显示用户名）
  
- ✅ `GET /api/plaza/animations` - 获取广场列表
  - 返回所有 `is_public = true` 的动画
  - 按 `like_count` 降序排序

**前端（1小时）：**
1. 创建 `PlazaPanel.jsx` - 广场面板组件
   - 位置：页面底部
   - 横向滚动
   - 显示卡片（封面 + 名称 + ❤️数字）
   
2. 修改 `MyAnimationsPanel.jsx` - 添加卡片菜单
   - 卡片悬浮 → 右上角显示"⋯"
   - 点击显示菜单：
     - 🗑️ 删除
     - 📤 上传到广场
     - 🔗 分享（暂时禁用，后面做）
   
3. 修改 `SaveAnimationModal.jsx` - 添加"上传到广场"询问
   - 保存成功后弹窗
   - "是否同时上传到广场？"
   - 选项：显示用户名 / 匿名
   - 按钮：暂不了 / 分享到广场
   - 复选框：□ 不再提醒

**验收标准：**
- ✅ 底部有广场面板
- ✅ "我的动画"卡片有菜单
- ✅ 点击"上传" → 广场中出现该动画
- ✅ 保存时有询问弹窗（可选不再提醒）

---

### 🎨 第二阶段：广场加载 + 信息展示（1小时）

#### 要做什么
1. 点击广场卡片 → 动画加载到画布
2. 卡片进入选中状态（放大 + 蓝色边框）
3. 画布下方显示动画信息区（名称、描述、点赞数、作者）

#### 具体任务

**后端（10分钟）：**
- ✅ `GET /api/plaza/animations/{id}` - 获取广场动画详情
  - 公开接口，不需要登录
  - 返回完整 scene_data

**前端（50分钟）：**
1. 修改 `PlazaPanel.jsx` - 添加点击事件
   - 点击卡片 → 调用 loadAnimation
   - 管理选中状态（selectedCardId）
   - 选中的卡片：scale(1.05) + 蓝色边框
   
2. 创建 `AnimationInfoBar.jsx` - 动画信息区
   - 位置：画布下方
   - 显示：📝 名称、描述、❤️ 点赞数、👤 作者
   - 只在加载广场动画时显示
   
3. 修改 `PhysicsPage.jsx` - 集成信息区组件

**验收标准：**
- ✅ 点击广场卡片 → 卡片高亮
- ✅ 画布加载该动画
- ✅ 下方显示动画信息
- ✅ 点击"开始模拟" → 正常运行

---

### 💗 第三阶段：点赞 + Fork（1.5小时）

#### 要做什么
1. 实现点赞功能（两个地方都能点）
2. 实现 Fork 功能（把广场动画复制到我的动画）

#### 具体任务

**后端（45分钟）：**
- ✅ `POST /api/plaza/animations/{id}/like` - 点赞
- ✅ `DELETE /api/plaza/animations/{id}/like` - 取消点赞
- ✅ `GET /api/plaza/animations/{id}/like-status` - 查询点赞状态
- ✅ `POST /api/plaza/animations/{id}/fork` - Fork 动画

**前端（45分钟）：**
1. 创建点赞按钮组件
   - 未点赞：🤍 灰色
   - 已点赞：❤️ 红色
   - 点击切换 + 数字更新
   
2. 在两处添加点赞按钮：
   - 广场卡片上
   - 画布下方信息区
   
3. 修改"下载"按钮逻辑：
   - 如果是我的动画 → 更新保存
   - 如果是广场动画 → Fork

**验收标准：**
- ✅ 点击❤️能点赞，变红色，数字+1
- ✅ 再点击取消，变灰色，数字-1
- ✅ 刷新页面，点赞状态保持
- ✅ 点击"下载" → Fork 成功，出现在"我的动画"

---

### 🔗 第四阶段：分享链接（1小时）

#### 要做什么
生成一个分享链接，朋友打开后能直接看到并运行动画

#### 具体任务

**后端（30分钟）：**
- ✅ `POST /api/animations/{id}/share-link` - 生成分享链接
  - 生成6位随机码
  - 返回完整链接
  
- ✅ `GET /api/play/{share_code}` - 获取动画数据

**前端（30分钟）：**
1. 在"我的动画"菜单中启用"分享"按钮
2. 点击 → 弹窗显示链接 + 复制按钮
3. 创建播放页：`/physics/play/:shareCode`
   - 精简 UI，只有画布
   - 自动加载并运行
   - 显示"Fork 到我的动画"按钮

**验收标准：**
- ✅ 点击分享 → 显示链接
- ✅ 点击复制 → 提示已复制
- ✅ 打开链接 → 跳转到播放页
- ✅ 播放页自动运行动画

---

## 📊 时间总览

| 阶段 | 任务 | 预计时间 | 累计 |
|------|------|---------|------|
| 1 | 广场面板 + 上传功能 | 1.5小时 | 1.5h |
| 2 | 广场加载 + 信息展示 | 1小时 | 2.5h |
| 3 | 点赞 + Fork | 1.5小时 | 4h |
| 4 | 分享链接 | 1小时 | 5h |

**总计：约 5 小时**

---

## 💡 为什么你的思路更好

### ✅ 你的规划优点

1. **逻辑清晰**
   - 先有广场 → 才能上传
   - 先能看到 → 再加交互
   - 先基础功能 → 再高级功能

2. **便于测试**
   - 每个阶段都有明确的验收点
   - 出问题容易定位

3. **用户体验好**
   - 保存时就可以选择上传
   - 一步到位，不用事后再操作

4. **分享链接最后做**
   - 分享功能相对独立
   - 不影响核心流程
   - 可以后期优化

---

## 🎯 关键改进点

### 1. 保存时的询问弹窗
```
保存成功后：
┌──────────────────────────────┐
│  ✅ 动画已保存到我的动画库    │
│                              │
│  是否同时上传到动画广场？     │
│  其他用户可以看到并使用       │
│                              │
│  □ 不再提醒                  │
│                              │
│  是否显示用户名？             │
│  ○ 显示  ● 匿名              │
│                              │
│  [暂不了]  [上传到广场]      │
└──────────────────────────────┘
```

### 2. 阶段式实现
- **阶段1**：能上传、能看到（核心）
- **阶段2**：能加载、能展示（体验）
- **阶段3**：能点赞、能 Fork（互动）
- **阶段4**：能分享（传播）

---

## 🚀 实施建议

### 推荐方式：分2天完成

**第1天（2.5小时）：** 阶段1 + 阶段2
- 做完看到：广场有动画，能上传，能加载

**第2天（2.5小时）：** 阶段3 + 阶段4
- 做完看到：能点赞，能Fork，能分享

### 或者一次性完成（5小时）
- 适合周末有整块时间
- 一气呵成

---

## 🎮 现在可以开始了

**告诉我：**

### 选项A：立即开始阶段1
"好的，开始第一阶段"
→ 我会做：广场面板 + 上传功能 + 保存询问弹窗

### 选项B：一次性做完全部
"一次性把4个阶段全做完"
→ 我会按顺序完成所有功能

### 选项C：先看看某个阶段的详细实现
"先详细说说阶段X怎么做"
→ 我会展开具体代码和步骤

---

**我强烈建议按你的思路做！逻辑更清晰，更符合实际使用场景。** ✅

**准备好了吗？告诉我开始哪个！** 🚀

